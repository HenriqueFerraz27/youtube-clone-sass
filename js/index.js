const avatarProfile = "./assets/images/avatars/avatar-profile.png";

const videoInfos = {
  src: "./assets/videos/Yunk Vino - Leans Pt. 2 (Prod. Volp) [Official Video].mp4",
  title: "Yunk Vino - Leans Pt. 2 (Prod. Volp) [Official Video]",
  views: 15094631,
  date: new Date("2020-04-11T12:00:00.000Z"),
  likes: 213000,
  commentsNumber: 2900,
};

const videoChannel = {
  avatar:
    "https://yt3.ggpht.com/ZvlREfSJhrFtdYgRlZcvS0zp-OVTRkEj0BBualfa4QPxoMj5pexKTEmPNHlct5wi6R8Jg-pf0NY=s48-c-k-c0x00ffffff-no-rj",
  ownerName: "Yunk Vino",
  subscribeds: 356000,
};

const videoDescription = `Video Clipe Oficial "Leans Pt. 2"

Mixtape "237" Lorem ipsum dolor sit amet consectetur adipisicing elit. Optio fugit deleniti assumenda consequatur necessitatibus quibusdam facilis, repellendus quo perferendis voluptatibus impedit doloribus, tenetur iure vel veniam, sint exercitationem? Commodi, unde.

Produção Musical: Volp

Direção: Fe Tavares

Produção Executiva: Labbel Records

Imagens: Ygor Carvalho e Fe Tavares

Drone imagens: Moysah

Edição: Tired Theo

Finalização: Fe Tavares

Styling: Naiara Albuquerque

Agradecimentos: Fera Mix`;

const videoComments = [
  {
    avatar: "./assets/images/avatars/avatar-profile.png",
    userName: "aurelia7751",
    date: new Date("2020-04-11T12:00:00.000Z"),
    comment:
      "Hoje essa música bateu em minha mente novamente, Tmj galerinha que sobrevive a guerra contra si todos os dias, incluindo hoje",
    likes: 306,
    answers: [
      {
        avatar: "./assets/images/avatars/avatar-profile.png",
        userName: "aurelia7751",
        date: new Date("2020-04-11T12:00:00.000Z"),
        comment:
          "Hoje essa música bateu em minha mente novamente, Tmj galerinha que sobrevive a guerra contra si todos os dias, incluindo hoje",
        likes: 306,
      },
      {
        avatar: "./assets/images/avatars/avatar-profile.png",
        userName: "aurelia7751",
        date: new Date("2020-04-11T12:00:00.000Z"),
        comment:
          "Hoje essa música bateu em minha mente novamente, Tmj galerinha que sobrevive a guerra contra si todos os dias, incluindo hoje",
        likes: 306,
      },
    ],
  },
  ,
  {
    avatar: "./assets/images/avatars/avatar-profile.png",
    userName: "pedro7751",
    date: new Date("2020-04-11T12:00:00.000Z"),
    comment:
      "Hoje essa música bateu em minha mente novamente, Tmj galerinha que sobrevive a guerra contra si todos os dias, incluindo hoje",
    likes: 306,
    answers: [
      {
        avatar: "./assets/images/avatars/avatar-profile.png",
        userName: "aurelia7751",
        date: new Date("2020-04-11T12:00:00.000Z"),
        comment:
          "Hoje essa música bateu em minha mente novamente, Tmj galerinha que sobrevive a guerra contra si todos os dias, incluindo hoje",
        likes: 306,
      },
      {
        avatar: "./assets/images/avatars/avatar-profile.png",
        userName: "aurelia7751",
        date: new Date("2020-04-11T12:00:00.000Z"),
        comment:
          "Hoje essa música bateu em minha mente novamente, Tmj galerinha que sobrevive a guerra contra si todos os dias, incluindo hoje",
        likes: 306,
      },
    ],
  },
];

const videosRecommendations = [
  {
    thumb: "./assets/images/thumbs/dialogo.jpg",
    time: "2:22",
    title: "1. Yunk Vino - Dialogo [Official Audio]",
    channelName: "Yunk Vino",
    channelAvatar:
      "https://yt3.ggpht.com/ZvlREfSJhrFtdYgRlZcvS0zp-OVTRkEj0BBualfa4QPxoMj5pexKTEmPNHlct5wi6R8Jg-pf0NY=s48-c-k-c0x00ffffff-no-rj",
    views: 5748811,
    date: new Date("2023-04-27T12:00:00.000Z"),
  },
  {
    thumb: "./assets/images/thumbs/dialogo.jpg",
    time: "2:22",
    title: "1. Yunk Vino - Dialogo [Official Audio]",
    channelName: "Yunk Vino",
    channelAvatar:
      "https://yt3.ggpht.com/ZvlREfSJhrFtdYgRlZcvS0zp-OVTRkEj0BBualfa4QPxoMj5pexKTEmPNHlct5wi6R8Jg-pf0NY=s48-c-k-c0x00ffffff-no-rj",
    views: 5748811,
    date: new Date("2023-04-27T12:00:00.000Z"),
  },
  {
    thumb: "./assets/images/thumbs/dialogo.jpg",
    time: "2:22",
    title: "1. Yunk Vino - Dialogo [Official Audio]",
    channelName: "Yunk Vino",
    channelAvatar:
      "https://yt3.ggpht.com/ZvlREfSJhrFtdYgRlZcvS0zp-OVTRkEj0BBualfa4QPxoMj5pexKTEmPNHlct5wi6R8Jg-pf0NY=s48-c-k-c0x00ffffff-no-rj",
    views: 5748811,
    date: new Date("2023-04-27T12:00:00.000Z"),
  },
  {
    thumb: "./assets/images/thumbs/dialogo.jpg",
    time: "2:22",
    title: "1. Yunk Vino - Dialogo [Official Audio]",
    channelName: "Yunk Vino",
    channelAvatar:
      "https://yt3.ggpht.com/ZvlREfSJhrFtdYgRlZcvS0zp-OVTRkEj0BBualfa4QPxoMj5pexKTEmPNHlct5wi6R8Jg-pf0NY=s48-c-k-c0x00ffffff-no-rj",
    views: 5748811,
    date: new Date("2023-04-27T12:00:00.000Z"),
  },
  {
    thumb: "./assets/images/thumbs/dialogo.jpg",
    time: "2:22",
    title: "1. Yunk Vino - Dialogo [Official Audio]",
    channelName: "Yunk Vino",
    channelAvatar:
      "https://yt3.ggpht.com/ZvlREfSJhrFtdYgRlZcvS0zp-OVTRkEj0BBualfa4QPxoMj5pexKTEmPNHlct5wi6R8Jg-pf0NY=s48-c-k-c0x00ffffff-no-rj",
    views: 5748811,
    date: new Date("2023-04-27T12:00:00.000Z"),
  },
  {
    thumb: "./assets/images/thumbs/dialogo.jpg",
    time: "2:22",
    title: "1. Yunk Vino - Dialogo [Official Audio]",
    channelName: "Yunk Vino",
    channelAvatar:
      "https://yt3.ggpht.com/ZvlREfSJhrFtdYgRlZcvS0zp-OVTRkEj0BBualfa4QPxoMj5pexKTEmPNHlct5wi6R8Jg-pf0NY=s48-c-k-c0x00ffffff-no-rj",
    views: 5748811,
    date: new Date("2023-04-27T12:00:00.000Z"),
  },
  {
    thumb: "./assets/images/thumbs/dialogo.jpg",
    time: "2:22",
    title: "1. Yunk Vino - Dialogo [Official Audio]",
    channelName: "Yunk Vino",
    channelAvatar:
      "https://yt3.ggpht.com/ZvlREfSJhrFtdYgRlZcvS0zp-OVTRkEj0BBualfa4QPxoMj5pexKTEmPNHlct5wi6R8Jg-pf0NY=s48-c-k-c0x00ffffff-no-rj",
    views: 5748811,
    date: new Date("2023-04-27T12:00:00.000Z"),
  },
  {
    thumb: "./assets/images/thumbs/dialogo.jpg",
    time: "2:22",
    title: "1. Yunk Vino - Dialogo [Official Audio]",
    channelName: "Yunk Vino",
    channelAvatar:
      "https://yt3.ggpht.com/ZvlREfSJhrFtdYgRlZcvS0zp-OVTRkEj0BBualfa4QPxoMj5pexKTEmPNHlct5wi6R8Jg-pf0NY=s48-c-k-c0x00ffffff-no-rj",
    views: 5748811,
    date: new Date("2023-04-27T12:00:00.000Z"),
  },
  {
    thumb: "./assets/images/thumbs/dialogo.jpg",
    time: "2:22",
    title: "1. Yunk Vino - Dialogo [Official Audio]",
    channelName: "Yunk Vino",
    channelAvatar:
      "https://yt3.ggpht.com/ZvlREfSJhrFtdYgRlZcvS0zp-OVTRkEj0BBualfa4QPxoMj5pexKTEmPNHlct5wi6R8Jg-pf0NY=s48-c-k-c0x00ffffff-no-rj",
    views: 5748811,
    date: new Date("2023-04-27T12:00:00.000Z"),
  },
  {
    thumb: "./assets/images/thumbs/dialogo.jpg",
    time: "2:22",
    title: "1. Yunk Vino - Dialogo [Official Audio]",
    channelName: "Yunk Vino",
    channelAvatar:
      "https://yt3.ggpht.com/ZvlREfSJhrFtdYgRlZcvS0zp-OVTRkEj0BBualfa4QPxoMj5pexKTEmPNHlct5wi6R8Jg-pf0NY=s48-c-k-c0x00ffffff-no-rj",
    views: 5748811,
    date: new Date("2023-04-27T12:00:00.000Z"),
  },
];

// ===============================================================
// ===============================================================
// ===============================================================

const formatTimeAgo = (oldDate) => {
  const timeDifferenceInMilliseconds = Math.abs(new Date() - oldDate);

  const minuteInMilliseconds = 60 * 1000;
  const hourInMilliseconds = 60 * minuteInMilliseconds;
  const dayInMilliseconds = 24 * hourInMilliseconds;
  const weekInMilliseconds = 7 * dayInMilliseconds;
  const monthInMilliseconds = 30 * dayInMilliseconds; // Aproximação
  const yearInMilliseconds = 365 * dayInMilliseconds; // Aproximação

  if (timeDifferenceInMilliseconds < minuteInMilliseconds) {
    return "agora mesmo";
  } else if (timeDifferenceInMilliseconds < hourInMilliseconds) {
    const minutes = Math.floor(
      timeDifferenceInMilliseconds / minuteInMilliseconds
    );
    return `há ${minutes} ${minutes === 1 ? "minuto" : "minutos"}`;
  } else if (timeDifferenceInMilliseconds < dayInMilliseconds) {
    const hours = Math.floor(timeDifferenceInMilliseconds / hourInMilliseconds);
    return `há ${hours} ${hours === 1 ? "hora" : "horas"}`;
  } else if (timeDifferenceInMilliseconds < weekInMilliseconds) {
    const days = Math.floor(timeDifferenceInMilliseconds / dayInMilliseconds);
    return `há ${days} ${days === 1 ? "dia" : "dias"}`;
  } else if (timeDifferenceInMilliseconds < monthInMilliseconds) {
    const weeks = Math.floor(timeDifferenceInMilliseconds / weekInMilliseconds);
    return `há ${weeks} ${weeks === 1 ? "semana" : "semanas"}`;
  } else if (timeDifferenceInMilliseconds < yearInMilliseconds) {
    const months = Math.floor(
      timeDifferenceInMilliseconds / monthInMilliseconds
    );
    return `há ${months} ${months === 1 ? "mês" : "meses"}`;
  } else {
    const years = Math.floor(timeDifferenceInMilliseconds / yearInMilliseconds);
    return `há ${years} ${years === 1 ? "ano" : "anos"}`;
  }
};

const videoNumberFormat = (number, useKAndM = true) => {
  if (!useKAndM) {
    return number.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
  }

  if (number >= 1e6) {
    return (number / 1e6).toFixed(number % 1e6 === 0 ? 0 : 1) + "M";
  } else if (number >= 1e3) {
    return (number / 1e3).toFixed(number % 1e3 === 0 ? 0 : 1) + "K";
  } else {
    return number.toString();
  }
};

const mobile = document.querySelector(".main--mobile");
const desktop = document.querySelector(".main--desktop");

const avatarProfileHeader = (document.querySelector(".avatar__profile").src =
  avatarProfile);

mobile.querySelector(".video__video").src = videoInfos.src;
desktop.querySelector(".video__video").src = videoInfos.src;

mobile.querySelector(".video__title").innerHTML = videoInfos.title;
desktop.querySelector(".video__title").innerHTML = videoInfos.title;

mobile.querySelector(".description__video-title").innerHTML = videoInfos.title;
desktop.querySelector(".description__video-title").innerHTML = videoInfos.title;

const viewsElements = document.querySelectorAll(".views");
viewsElements.forEach((viewsElement) => {
  viewsElement.innerHTML = videoNumberFormat(videoInfos.views);
});

const timeElements = document.querySelectorAll(".video__time");
timeElements.forEach((timeElement) => {
  timeElement.innerHTML = formatTimeAgo(videoInfos.date);
});

const videoMounth = (mobile.querySelector(".video__year").innerHTML =
  videoInfos.date.getFullYear());
mobile.querySelector(".video__day").innerHTML = videoInfos.date.getDay();
mobile.querySelector(".video__month").innerHTML = new Intl.DateTimeFormat(
  "pt-BR",
  { month: "short" }
).format(videoInfos.date);

document.querySelector(".description-views").innerHTML = videoNumberFormat(
  videoInfos.views,
  false
);

const likesElements = document.querySelectorAll(".likes");
likesElements.forEach((likesElement) => {
  likesElement.innerHTML = videoNumberFormat(videoInfos.likes);
});

mobile.querySelector(".video__channel__owner__avatar").src =
  videoChannel.avatar;
mobile.querySelector(".video__channel__owner__name").innerHTML =
  videoChannel.ownerName;
mobile.querySelector(".video__channel__owner__subscribeds").innerHTML =
  videoNumberFormat(videoChannel.subscribeds);

desktop.querySelector(".video__channel__owner__avatar").src =
  videoChannel.avatar;
desktop.querySelector(".video__channel__owner__name").innerHTML =
  videoChannel.ownerName;
desktop.querySelector(".video__channel__owner__subscribeds").innerHTML =
  videoNumberFormat(videoChannel.subscribeds);

mobile.querySelector(".comments-number").innerHTML = videoNumberFormat(
  videoInfos.commentsNumber,
  false
);
desktop.querySelector(".comments-number").innerHTML = videoNumberFormat(
  videoInfos.commentsNumber,
  false
);

mobile.querySelector(".description__content").innerHTML =
  videoDescription.replace(/\n/g, "<br>");
desktop
  .querySelector(".video__description--desktop")
  .querySelector(".description__content").innerHTML = videoDescription.replace(
  /\n/g,
  "<br>"
);

const videoCommentsJSX = videoComments
  .map((comment) => {
    return ` <div class="comment">
<img class="avatar" src=${comment.avatar} />

<div class="comment__container">
  <div class="comment__wrapper">
    <div class="comment__wrapper-2">
      <div class="comment__content">
        <header>@${comment.userName} • ${formatTimeAgo(comment.date)}</header>

        <p>
        ${comment.comment}
        </p>
      </div>

      <div class="comment__feedback">
        <div>
          <button>
            <img
            class="like"
              src="./assets/images/icons/light-white-like.svg"
              alt="Like"
            />
            ${comment.likes}
          </button>

          <span></span>

          <button>
            <img
            class="dislike"
              src="./assets/images/icons/light-white-dislike.svg"
              alt="Like"
            />
          </button>
        </div>
      </div>
    </div>

    <button class="comment__options">
      <span> ••• </span>
    </button>
  </div>

  ${
    comment.answers &&
    `<div class="comment__answers">
  <div class="comment__answers__content">

  ${comment.answers
    .map((commentAnswer) => {
      return `<div class="comment">
    <img
      class="avatar"
      src=${commentAnswer.avatar}
      alt="Perfil"
    />

    <div class="comment__container">
      <div class="comment__wrapper-2">
        <div class="comment__content">
          <header>@${commentAnswer.userName} • ${formatTimeAgo(
        commentAnswer.date
      )}</header>

          <p>
          ${commentAnswer.comment}
          </p>
        </div>

        <div class="comment__feedback">
          <div>
            <button>
              <img
              class="like"
                src="./assets/images/icons/light-white-like.svg"
                alt="Like"
              />
              ${commentAnswer.likes}
            </button>

            <span></span>

            <button>
              <img
                src="./assets/images/icons/light-white-dislike.svg"
                alt="Like"
              />
            </button>
          </div>
        </div>
      </div>

      <button class="comment__options">
        <span> ••• </span>
      </button>
    </div>
  </div>`;
    })
    .join("")}

    
  </div>

  <button class="comment__answers__expand">
    <img
      src="./assets/images/icons/solid-blue-arrow-down.svg"
      alt="Expandir Respostas"
    />
    187 respostas
  </button>
</div>`
  }

  
</div>
</div>
`;
  })
  .join("");

mobile.querySelector(".comments__comments").innerHTML = videoCommentsJSX;
desktop.querySelector(".comments__comments").innerHTML = videoCommentsJSX;

mobile.querySelector(".comments__expand__avatar").src = videoComments[0].avatar;
mobile.querySelector(".comments__expand__comment__content").innerHTML = videoComments[0].comment;

desktop.querySelector(".comments__expand__avatar").src = videoComments[0].avatar;
desktop.querySelector(".comments__expand__comment__content").innerHTML = videoComments[0].comment;

const videosRecommendationsMobile = videosRecommendations.map((video) => {
  return `<div class="compact-video">
  <button class="compact-video__thumb-button container">
    <img
      class="compact-video__thumb"
      src=${video.thumb}
      alt="${video.title}"
    />

    <span class="compact-video__thumb-time">${video.time}</span>
  </button>

  <div class="compact-video__wrapper container">
    <div class="compact-video__channel-infos">
      <button class="compact-video__channel">
        <img
          class="avatar"
          src=${video.channelAvatar}
          alt=${video.channelName}
        />
      </button>

      <button class="compact-video__infos">
        <strong>${video.title}</strong>
        <span>${video.channelName} • ${videoNumberFormat(
    video.views
  )} visualizações • ${formatTimeAgo(video.date)}</span>
      </button>
    </div>

    <button class="compact-video__options">
      <span> ••• </span>
    </button>
  </div>
</div>`;
}).join("");

const videosRecommendationsDesktop = videosRecommendations.map((video) => {
  return `<div class="compact-video">
  <div class="compact-video__thumb-infos">
    <button class="compact-video__thumb-button">
      <img
        class="compact-video__thumb"
        src=${video.thumb}
        alt=${video.title}
      />

      <div>
        <span>
          <img
            src="./assets/images/icons/regular-white-clock.svg"
            alt="Assistir Mais Tarde"
          />
        </span>
        <span
          ><img
            src="./assets/images/icons/regular-white-playlist-play.svg"
            alt="Adicionar a Playlist"
        /></span>
      </div>

      <span class="compact-video__thumb__time">${video.time}</span>
    </button>

    <button class="compact-video__infos">
      <strong>${video.title}</strong>
      <span>${video.channelName}</span>
      <span>${videoNumberFormat(video.views)} visualizações • ${formatTimeAgo(
    video.date
  )}</span>
    </button>
  </div>

  <button class="compact-video__options">
    <span> ••• </span>
  </button>
</div>`;
}).join("");

mobile.querySelector(".videos-recommendations").innerHTML =
  videosRecommendationsMobile;
desktop.querySelector(".videos-recommendations").innerHTML =
  videosRecommendationsDesktop;

const likes = document.querySelectorAll(".like");
likes.forEach((like) => {
  like.addEventListener("click", () => {
    like.src ===
    "http://127.0.0.1:5500/assets/images/icons/light-white-like.svg"
      ? (like.src = "./assets/images/icons/solid-white-like.svg")
      : (like.src = "./assets/images/icons/light-white-like.svg");
  });
});

const dislikes = document.querySelectorAll(".dislike");
dislikes.forEach((dislike) => {
  dislike.addEventListener("click", () => {
    dislike.src ===
    "http://127.0.0.1:5500/assets/images/icons/light-white-dislike.svg"
      ? (dislike.src = "./assets/images/icons/solid-white-dislike.svg")
      : (dislike.src = "./assets/images/icons/light-white-dislike.svg");
  });
});
